# AIナレッジアシスタント

## AIナレッジアシスタントとは

AIナレッジアシスタント（以下、「ナレッジアシスタント」と呼びます）は、ユーザーの質問に対して、GROWI 内の情報をもとにチャット形式で質問に回答する機能です。

GROWI v7.1.0 以降のバージョンで利用可能であり、v7.2.0 以降では各ユーザーが任意のページ群に特化したナレッジアシスタントを自由に作成できるようになりました。

## ナレッジアシスタントが取り扱うデータについて

GROWI AI 連携機能では、OpenAI の Vector Store へ文書をアップロードして機械学習の対象とします。

AI 連携機能が有効な場合、ページの作成・更新・複製・削除のアクションが起こったときに、ページの本文ほか機械学習に必要なメタデータを Vector Store へアップロードします。

## ナレッジアシスタント機能の特徴

### 新旧バージョンの機能比較

ナレッジアシスタントはバージョンによって機能や特性が大きく異なります。v7.1.0で導入された初期バージョンと比較して、v7.2.0以降では機能が大幅に拡張されています。特に重要な変更点として、学習対象となるページの権限管理とデータアクセスの仕組みが根本的に変わりました。

::: warning
v7.2.0以降のバージョンでは、権限制限のあるページ（非公開ページやグループ限定ページ）も学習対象に含めることができるようになりました。このため、アシスタント作成時および共有設定時には、機密情報や制限付き情報の取り扱いに十分注意する必要があります。特にチーム公開設定を行う場合は、意図しない情報漏洩が起こらないよう慎重に設定してください。
:::

|  | 旧バージョン (v7.1.0) | 新バージョン (v7.2.0以降) |
|---|---|---|
| 学習対象にできるページ | 公開権限が「公開」のページのみ | アシスタント作成者のアクセス可能なすべてのページ |
| カスタマイズ性 | - | 任意のページ群に特化したアシスタントを作成できる |
| 情報管理 | - | 権限付きページも学習対象となるため注意が必要 |
| アシスタントの共有設定 | - | 個人用・チーム用など個別に選択できる |



## ナレッジアシスタントの作成手順

### 新規アシスタントの追加画面を開く

1. 左サイドバーの 「AI」ボタンをクリックします。
1. 「アシスタントを追加する」ボタンをクリックします。

### アシスタント名を入力する

表示された新規アシスタントの追加画面で、以下を入力します。

- アシスタント名 : アシスタントの一覧画面に表示される名前
- アシスタントのメモ(任意) : 用途などを自由に記載（アシスタントの処理には影響しません）

### アシスタントの共有設定をする

- アシスタントを共有する: 作成したアシスタントを他のユーザーと共有したい場合は、ボタンをクリックして有効にします

- ページのアクセス権限:
  - 学習対象のページを、ページのアクセス権限設定により絞り込めます
  - アシスタント作成者が閲覧できるページのみ選択できます

- アシスタントの共有範囲:
  - 作成したアシスタントの共有範囲を設定できます
  - アシスタントの共有範囲が 「全体公開」 のもののみがデフォルトアシスタントに設定できます
  - アシスタントが限定公開ページ（非公開ページやグループ限定ページ）を含んでいる場合、それらを本来アクセスできないユーザーと共有を試みると「共有範囲の確認」という警告メッセージが表示されます。これにより、意図しない情報漏洩を防止します。

### 参照ページを追加する

アシスタントが参照(学習)するページを設定できます。参照できるページは、配下ページを含め、デフォルト設定では 3000 ページまでです。 (環境変数で変更できます)

1. ページを追加するボタンを押すと、参照可能なすべてのページリストが表示されます
1. 参照ページとして設定したいページをクリックします
1. 配下ページも含めるかどうかのチェックボックスにチェックを入れます
1. 完了ボタンを押します
1. 「ページを追加する」ボタンの下に、参照ページとして設定されたページのパスが表示されます (配下ページも含めた場合は、末尾のパスが `/*` になります)
1. 他にも追加したい場合は、また「ページを追加する」ボタンから同様の作業を繰り返します。

### 参照ページを削除する

一度設定した参照ページを削除したい場合は、ごみ箱アイコンで削除できます。

### アシスタントへの指示を設定する

アシスタントごとに独自の応答スタイルや行動指針を設定できる機能です。これは OpenAI の [Create Run API](https://platform.openai.com/docs/api-reference/runs/createRun) の additional_instructions パラメータを通じて実現されます。

例えば「専門用語を使わず、小学生にもわかる言葉で説明してください」と入力すると、簡潔で分かりやすい説明になります。

## ナレッジアシスタントの使い方

1. GROWI 画面右上の「AI」アイコンをクリックすると、デフォルトアシスタントとのチャットが開始されます。
1. または、ナレッジアシスタント一覧から利用したいアシスタントを選択してチャットを開始できます。
1. チャットウィンドウに質問を入力すると、アシスタントが GROWI 内の関連情報をもとに回答します。

## チャット履歴について

ナレッジアシスタントとの対話はすべて履歴として保存され、後から参照できます。

- チャット履歴はユーザーごとに保存され、過去の質問と回答を確認できます。
- チャット履歴はアシスタントごとに整理されており、複数のナレッジアシスタントを使い分けている場合も、それぞれの会話を個別に参照できます。
- 各アシスタントのツリーを展開すると、過去のスレッドが表示されます。

### チャット履歴の保存期間

- 各スレッドは、最後の会話から3日間保存されます。
- 3日間が経過すると、スレッドは自動的に削除されます。
- 既存のスレッドを開いて新しい質問をすると、そのスレッドの保存期間が再び3日間に延長されます。

## デフォルトアシスタントについて

任意のナレッジアシスタントを、「デフォルトアシスタント」として登録できます。

- デフォルトアシスタントは、上部のページツールボタンの「AI」吹き出しアイコンから1クリックで起動できます。
- アシスタント一覧でデフォルト設定したいアシスタントの横にある「★」マークをクリックすることで設定できます。
- アシスタントの共有範囲が「全体公開」のものだけがデフォルトアシスタントに設定できます。また、デフォルトアシスタントの設定は管理者権限を持つユーザーのみが行えます。

<img :src="$withBase('/assets/images/ja/ai-default-knowledge-assistant-balloon.png')" alt="ai-default-knowledge-assistant-balloon.png" class="border">

## 環境変数

ナレッジアシスタント機能の利用には、環境変数の設定が必要です。

詳細は [AI 連携機能のセットアップと管理](/ja/admin-guide/management-cookbook/setup-ai.html)をご参照ください。

- `AI_ENABLED` : `true` (デフォルト `false`)
- `OPENAI_SERVICE_TYPE` : `openai`
- `OPENAI_API_KEY` : OpenAI サービスで取得した API キーを指定
- `OPENAI_LIMIT_LEARNABLE_PAGE_COUNT_PER_ASSISTANT` (任意) : 1つのナレッジアシスタントが学習できるページの上限数 (デフォルトは 3000)
