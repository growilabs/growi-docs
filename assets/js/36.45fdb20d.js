(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{483:function(a,t,e){"use strict";e.r(t);var s=e(69),r=Object(s.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"mongodb-auto-backup"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-auto-backup"}},[a._v("#")]),a._v(" MongoDB Auto Backup")]),a._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#overview"}},[a._v("Overview")])]),e("li",[e("a",{attrs:{href:"#manage-with-a-container"}},[a._v("Manage with a Container")])]),e("li",[e("a",{attrs:{href:"#manage-with-docker-compose"}},[a._v("Manage with docker-compose")])]),e("li",[e("a",{attrs:{href:"#manage-with-google-cloud-platform"}},[a._v("Manage with Google Cloud Platform")])])])]),e("p"),a._v(" "),e("h2",{attrs:{id:"overview"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[a._v("#")]),a._v(" Overview")]),a._v(" "),e("p",[a._v("This chapter introduces how to set up auto backup for GROWI data using "),e("a",{attrs:{href:"https://github.com/weseek/mongodb-awesome-backup",target:"_blank",rel:"noopener noreferrer"}},[a._v("weseek/mongodb-awesome-backup"),e("OutboundLink")],1),a._v(".")]),a._v(" "),e("h4",{attrs:{id:"requirements"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#requirements"}},[a._v("#")]),a._v(" Requirements")]),a._v(" "),e("ul",[e("li",[a._v("Docker")]),a._v(" "),e("li",[a._v("AWS S3 bucket to upload backup files\n"),e("ul",[e("li",[a._v("Access key and secret key for a user authorized to access S3 bucket.")])])])]),a._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),e("p",[a._v("See "),e("RouterLink",{attrs:{to:"/en/admin-guide/admin-cookbook/mongodb-backup.html"}},[a._v("MongoDB Backup & Restore")]),a._v(" before you start.")],1)]),a._v(" "),e("h2",{attrs:{id:"manage-with-a-container"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#manage-with-a-container"}},[a._v("#")]),a._v(" Manage with a Container")]),a._v(" "),e("ol",[e("li",[e("p",[a._v("Start a container with CRONMODE "),e("code",[a._v("true")]),a._v(".")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--rm")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("MONGODB_HOST")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("Target MongoDB Host"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("AWS_ACCESS_KEY_ID")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("Your IAM Access Key ID"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("AWS_SECRET_ACCESS_KEY")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("Your IAM Secret Access Key"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("S3_TARGET_BUCKET_URL")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("Target S3 Bucket URL "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("s3://"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("CRONMODE")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("true "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"CRON_EXPRESSION=0 4 * * *"')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  weseek/mongodb-awesome-backup\n")])])])]),a._v(" "),e("li",[e("p",[a._v("The container backs up all databases in the target MongoDB server at 4:00 AM everyday.")])])]),a._v(" "),e("h4",{attrs:{id:"backup-version-control"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#backup-version-control"}},[a._v("#")]),a._v(" Backup Version Control")]),a._v(" "),e("ul",[e("li",[a._v("(TBD: Looking for a contributor)")])]),a._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),e("p",[a._v("See "),e("a",{attrs:{href:"https://github.com/weseek/mongodb-awesome-backup",target:"_blank",rel:"noopener noreferrer"}},[a._v("weseek/mongodb-awesome-backup"),e("OutboundLink")],1),a._v(" for more options.")])]),a._v(" "),e("h2",{attrs:{id:"manage-with-docker-compose"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#manage-with-docker-compose"}},[a._v("#")]),a._v(" Manage with docker-compose")]),a._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),e("p",[a._v("If GROWI is installed with "),e("RouterLink",{attrs:{to:"/en/admin-guide/getting-started/docker-compose.html"}},[a._v("growi-docker-compose")]),a._v(", preparing a backup container is even easier.")],1)]),a._v(" "),e("ul",[e("li",[a._v("Refer to growilabs/growi-docker-compose "),e("a",{attrs:{href:"https://github.com/growilabs/growi-docker-compose/tree/master/examples/backup-mongodb-data",target:"_blank",rel:"noopener noreferrer"}},[a._v("Example"),e("OutboundLink")],1),a._v(", and follow the steps below.")])]),a._v(" "),e("ol",[e("li",[e("p",[a._v("clone")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("git")]),a._v(" clone https://github.com/growilabs/growi-docker-compose.git growi\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" growi\n")])])])]),a._v(" "),e("li",[e("p",[a._v("Copy "),e("code",[a._v("docker-compose.override.yml")]),a._v(" to the root directory.")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" examples/backup-mongodb-data/docker-compose.override.yml "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\n")])])])]),a._v(" "),e("li",[e("p",[a._v("Edit "),e("code",[a._v("docker-compose.override.yml")]),a._v(" and enter an appropriate value for "),e("code",[a._v("CRON_EXPRESSION")]),a._v(", "),e("code",[a._v("AWS_ACCESS_KEY_ID")]),a._v(", "),e("code",[a._v("AWS_SECRET_ACCESS_KEY")]),a._v(", and "),e("code",[a._v("S3_TARGET_BUCKET_URL")]),a._v(".")]),a._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("...")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" CRONMODE=true\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" CRON_EXPRESSION=0 4 * * *\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" AWS_ACCESS_KEY_ID=$"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("Your IAM Access Key ID"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" AWS_SECRET_ACCESS_KEY=$"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("Your IAM Secret Access Key"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" S3_TARGET_BUCKET_URL=s3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("//$"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("Your Bucket Name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("/\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("...")]),a._v("\n")])])])]),a._v(" "),e("li",[e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker-compose")]),a._v(" up\n")])])])])]),a._v(" "),e("h2",{attrs:{id:"manage-with-google-cloud-platform"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#manage-with-google-cloud-platform"}},[a._v("#")]),a._v(" Manage with Google Cloud Platform")]),a._v(" "),e("ul",[e("li",[a._v("(TBD: Looking for a contributor)")])])])}),[],!1,null,null,null);t.default=r.exports}}]);