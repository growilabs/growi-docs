(window.webpackJsonp=window.webpackJsonp||[]).push([[164],{613:function(a,t,r){"use strict";r.r(t);var e=r(69),s=Object(e.a)({},(function(){var a=this,t=a.$createElement,r=a._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[r("h1",{attrs:{id:"hackmd-codimd-連携"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#hackmd-codimd-連携"}},[a._v("#")]),a._v(" HackMD(CodiMD)連携")]),a._v(" "),r("img",{attrs:{src:a.$withBase("/assets/images/hackmd-demo.gif"),alt:"HackMD Demo"}}),a._v(" "),r("h2",{attrs:{id:"概要"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#概要"}},[a._v("#")]),a._v(" 概要")]),a._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://hackmd.io",target:"_blank",rel:"noopener noreferrer"}},[a._v("HackMD"),r("OutboundLink")],1),a._v(" は、チームで単一の Markdown を同時に多人数で編集できるとても優れたツールです。")]),a._v(" "),r("li",[r("a",{attrs:{href:"https://github.com/hackmdio/codimd",target:"_blank",rel:"noopener noreferrer"}},[a._v("CodiMD"),r("OutboundLink")],1),a._v(" は HackMD からフォークした OSS です。")]),a._v(" "),r("li",[a._v("GROWI を HackMD/CodiMD と連携させることで、GROWI 管理下のドキュメントを同時に多人数で編集できるようになります。")])]),a._v(" "),r("h2",{attrs:{id:"仕組み"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#仕組み"}},[a._v("#")]),a._v(" 仕組み")]),a._v(" "),r("ul",[r("li",[a._v("GROWI に HackMD/CodiMD 連携設定をすることで、HackMD/CodiMD のエディタを iframe 内に借りる形で表示できます。")]),a._v(" "),r("li",[a._v("ページのデータは "),r("a",{attrs:{href:"https://developer.mozilla.org/ja/docs/Web/API/Window/postMessage",target:"_blank",rel:"noopener noreferrer"}},[a._v("window.postMessage"),r("OutboundLink")],1),a._v(" を介して共有されます。")])]),a._v(" "),r("h2",{attrs:{id:"growi-docker-compose-で新しく-hackmd-codimd-コンテナを立てる"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#growi-docker-compose-で新しく-hackmd-codimd-コンテナを立てる"}},[a._v("#")]),a._v(" "),r("RouterLink",{attrs:{to:"/ja/admin-guide/getting-started/docker-compose.html"}},[a._v("growi-docker-compose")]),a._v(" で新しく HackMD(CodiMD) コンテナを立てる")],1),a._v(" "),r("p",[r("a",{attrs:{href:"https://github.com/growilabs/growi-docker-compose/tree/master/examples/integrate-with-hackmd",target:"_blank",rel:"noopener noreferrer"}},[a._v("こちら"),r("OutboundLink")],1),a._v(" の Example を利用します。")]),a._v(" "),r("p",[r("a",{attrs:{href:"https://github.com/growilabs/growi-docker-compose/blob/master/examples/integrate-with-hackmd/README.md",target:"_blank",rel:"noopener noreferrer"}},[a._v("README.md"),r("OutboundLink")],1),a._v(" の内容に従ってセットアップします。")]),a._v(" "),r("ol",[r("li",[r("code",[a._v("examples/integrate-with-hackmd/docker-compose.override.yml")]),a._v(" を用意")]),a._v(" "),r("li",[a._v("GROWI コンテナに環境変数を設定\n"),r("ul",[r("li",[r("code",[a._v("HACKMD_URI")]),a._v(": GROWI のクライアントを実行するブラウザからアクセス可能な CodiMD の URI")]),a._v(" "),r("li",[r("code",[a._v("HACKMD_URI_FOR_SERVER")]),a._v(": GROWI サーバーからアクセス可能な CodiMD の URI\n"),r("ul",[r("li",[a._v("設定されなかった場合は "),r("code",[a._v("HACKMD_URI")]),a._v(" を利用します")])])])])]),a._v(" "),r("li",[a._v("CodiMD コンテナに環境変数を設定\n"),r("ul",[r("li",[r("code",[a._v("GROWI_URI")]),a._v(": GROWI のクライアントを実行するブラウザからアクセス可能な GROWI の URI")])])]),a._v(" "),r("li",[a._v("コンテナの起動")]),a._v(" "),r("li",[a._v("GROWI の管理画面の「アプリ設定」から、サイトURLを設定する\n"),r("ul",[r("li",[a._v("GROWI のクライアントを実行するブラウザからアクセス可能な GROWI の URI を入力")]),a._v(" "),r("li",[a._v("または環境変数 "),r("code",[a._v("APP_SITE_URL")]),a._v(" で設定")])])])]),a._v(" "),r("h2",{attrs:{id:"既存の-hackmd-codimd-と連携する"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#既存の-hackmd-codimd-と連携する"}},[a._v("#")]),a._v(" 既存の HackMD(CodiMD) と連携する")]),a._v(" "),r("h3",{attrs:{id:"growi-の設定"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#growi-の設定"}},[a._v("#")]),a._v(" GROWI の設定")]),a._v(" "),r("ol",[r("li",[a._v("以下の環境変数を設定\n"),r("ul",[r("li",[r("code",[a._v("HACKMD_URI")]),a._v(": GROWI のクライアントを実行するブラウザからアクセス可能な CodiMD の URI")]),a._v(" "),r("li",[r("code",[a._v("HACKMD_URI_FOR_SERVER")]),a._v(": GROWI サーバーからアクセス可能な CodiMD の URI\n"),r("ul",[r("li",[a._v("設定されなかった場合は "),r("code",[a._v("HACKMD_URI")]),a._v(" を利用します")])])])])]),a._v(" "),r("li",[a._v("再起動")]),a._v(" "),r("li",[a._v("GROWI の管理画面の「アプリ設定」から、サイトURLを設定する\n"),r("ul",[r("li",[a._v("GROWI のクライアントを実行するブラウザからアクセス可能な GROWI の URI を入力")]),a._v(" "),r("li",[a._v("または環境変数 "),r("code",[a._v("APP_SITE_URL")]),a._v(" で設定")])])])]),a._v(" "),r("h3",{attrs:{id:"hackmd-codimd-の設定"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#hackmd-codimd-の設定"}},[a._v("#")]),a._v(" HackMD(CodiMD) の設定")]),a._v(" "),r("ol",[r("li",[r("p",[a._v("以下の環境変数を設定")]),a._v(" "),r("ul",[r("li",[r("code",[a._v("GROWI_URI")]),a._v(": GROWI のクライアントを実行するブラウザからアクセス可能な GROWI の URI")])])]),a._v(" "),r("li",[r("p",[a._v("GROWI agent for HackMD を読み込むため、ejs を編集")]),a._v(" "),r("ul",[r("li",[r("p",[r("code",[a._v("/codimd/public/views/codimd/head.ejs")]),a._v(" の末尾に以下を追加")]),a._v(" "),r("div",{staticClass:"language-javascript extra-class"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("script src"),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),r("span",{pre:!0,attrs:{class:"token string"}},[a._v('"<%= process.env.GROWI_URI %>/_hackmd/load-styles"')]),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("script"),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])])]),a._v(" "),r("li",[r("p",[r("code",[a._v("/codimd/public/views/codimd/foot.ejs")]),a._v(" の末尾に以下を追加")]),a._v(" "),r("div",{staticClass:"language-javascript extra-class"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("script src"),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),r("span",{pre:!0,attrs:{class:"token string"}},[a._v('"<%= process.env.GROWI_URI %>/_hackmd/load-agent"')]),a._v(" defer"),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("script"),r("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])])])])]),a._v(" "),r("li",[r("p",[a._v("再起動")])])]),a._v(" "),r("h2",{attrs:{id:"動作確認"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#動作確認"}},[a._v("#")]),a._v(" 動作確認")]),a._v(" "),r("h3",{attrs:{id:"growi"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#growi"}},[a._v("#")]),a._v(" GROWI")]),a._v(" "),r("ul",[r("li",[a._v("任意の編集可能なページを表示した際に、HackMD タブが表示されていることを確認")])]),a._v(" "),r("h3",{attrs:{id:"hackmd-codimd"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#hackmd-codimd"}},[a._v("#")]),a._v(" HackMD(CodiMD)")]),a._v(" "),r("ul",[r("li",[r("p",[a._v("任意の編集可能なページを表示した際に、ブラウザのコンソールに以下のようなログが表示されていることを確認")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v("[GROWI] Loading styles for HackMD is not processed because currently not in iframe\n[GROWI] Loading agent for HackMD is not processed because currently not in iframe\n")])])])])]),a._v(" "),r("h2",{attrs:{id:"トラブルシュート"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#トラブルシュート"}},[a._v("#")]),a._v(" トラブルシュート")]),a._v(" "),r("h3",{attrs:{id:"growi-で-hackmd-タブが表示されない"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#growi-で-hackmd-タブが表示されない"}},[a._v("#")]),a._v(" GROWI で HackMD タブが表示されない")]),a._v(" "),r("ul",[r("li",[r("code",[a._v("HACKMD_URI")]),a._v(" に正しい値がセットされていることを確認してください")])]),a._v(" "),r("h3",{attrs:{id:"「start-to-edit-with-hackmd」ボタン押下時にエラー"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#「start-to-edit-with-hackmd」ボタン押下時にエラー"}},[a._v("#")]),a._v(" 「Start to edit with HackMD」ボタン押下時にエラー")]),a._v(" "),r("h4",{attrs:{id:"error-connecting-to-a-non-hackmd-server"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#error-connecting-to-a-non-hackmd-server"}},[a._v("#")]),a._v(" Error: Connecting to a non-HackMD server")]),a._v(" "),r("ul",[r("li",[r("code",[a._v("HACKMD_URI_FOR_SERVER")]),a._v(" に正しい値がセットされていることを確認してください")]),a._v(" "),r("li",[a._v("GROWI サーバーから HackMD/CodiMD に対する疎通を確認してください")])]),a._v(" "),r("h4",{attrs:{id:"growi-client-failed-to-connect-to-growi-agent-for-hackmd"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#growi-client-failed-to-connect-to-growi-agent-for-hackmd"}},[a._v("#")]),a._v(" GROWI client failed to connect to GROWI agent for HackMD")]),a._v(" "),r("ul",[r("li",[a._v("GROWI のサイトURLに正しい値がセットされていることを確認してください")]),a._v(" "),r("li",[a._v("既存の HackMD/CodiMD に変更を加えている場合、以下を確認してください\n"),r("ul",[r("li",[a._v("head.ejs, foot.ejs に記述した内容が正しいこと")]),a._v(" "),r("li",[a._v("HackMD/CodiMD のソース中に挿入された script タグの src のURLに正常にアクセスできる(css, JavaScript をロードできる)こと")])])])]),a._v(" "),r("h3",{attrs:{id:"編集後の「更新」ボタン押下時にエラー、加えて-growi-のセッションが切れる-ページ遷移するとログイン画面に戻される"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#編集後の「更新」ボタン押下時にエラー、加えて-growi-のセッションが切れる-ページ遷移するとログイン画面に戻される"}},[a._v("#")]),a._v(" 編集後の「更新」ボタン押下時にエラー、加えて GROWI のセッションが切れる(ページ遷移するとログイン画面に戻される)")]),a._v(" "),r("ul",[r("li",[a._v("GROWI と HackMD/CodiMD のセッション情報を保持するCookie名が "),r("code",[a._v("connect.sid")]),a._v(" で被っていることが原因です\n"),r("ul",[r("li",[a._v("GROWI の環境変数 "),r("code",[a._v("SESSION_NAME")]),a._v(" を変更してください")])])])])])}),[],!1,null,null,null);t.default=s.exports}}]);